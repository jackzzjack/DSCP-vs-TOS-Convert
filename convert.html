<html>
	<head>
		<!-- Include Jquery Library. -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

		<!-- Optional theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

		<!-- Latest compiled and minified JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		
		<!-- Callback event -->
		<script>
			FLAG_TYPE = 0;
			LOG_LEVEL = 0;
			
			function logd(msg) {
				if (LOG_LEVEL)
					console.log(msg);
			}
			
			function convert() {
				var dscp = get_check_DSCP_field();
				var tos = get_check_TOS_field();
				var ecn = get_check_ECN_field();
				var ipp = get_check_IPP_field();
				
				switch (FLAG_TYPE) {
					case 1:
						if (dscp == -1 || ecn == -1) {
							open_StatusDiv();
							
							return;
						}
						
						// Result
						// DSCP-ECN => IPP-TOS
						document.getElementById('TOS_input').value = (dscp & 7) << 2 | ecn;
						document.getElementById('IPP_input').value = (dscp >> 3);
						
						break;
					case 2:
						if (tos == -1 || ipp == -1) {
							open_StatusDiv();
							
							return;
						}
						
						// Result
						// DSCP-ECN => IPP-TOS
						document.getElementById('DSCP_input').value = 2;
						document.getElementById('ECN_input').value = 1;
						
						break;
				}
			}
			
			function get_check_DSCP_field() {
				var dscp = document.getElementById('DSCP_input').value;
				
				if (dscp > 63) {
					logd("DSCP too high.");
					
					return -1;
				}
				
				return dscp;
			}
			
			function get_check_TOS_field() {
				var tos = document.getElementById('TOS_input').value;
				
				if (tos > 31) {
					logd("TOS too high.");
					
					return -1;
				}
				
				return tos;
			}
			
			function get_check_ECN_field() {
				var ecn = document.getElementById('ECN_input').value;
				
				if (ecn > 3) {
					logd("ECN too high.");
					
					return -1;
				}
				
				return ecn;
			}
			
			function get_check_IPP_field() {
				var ipp = document.getElementById('IPP_input').value;
				
				if (ipp > 7) {
					logd("IP Precedence too high.");
					
					return -1;
				}
				
				return ipp;
			}
			
			function optionClick(type) {
				open_DataSection();
				open_SubmitSection();
				open_ConvertSection();
				
				switch (type) {
					case 1:
						type1_section();
						break;
					case 2:
						type2_section();
						break;
					default:
						break;
				}
			}
			
			function open_DataSection() {
				document.getElementById('data').hidden = false;
			}
			
			function open_SubmitSection() {
				document.getElementById('submit').hidden = false;
			} 
			
			function open_StatusDiv() {
				document.getElementById('check_status').style.visibility = "visible";
			}

			function open_ConvertSection() {
				document.getElementById('convert').hidden = false;
			}
			
			DSCP_ECN =
				'<div class="form-group col-md-6">\
					<label class="col-md-5">DSCP:</label>\
					<input id="DSCP_input" type="text" onfocusout="get_check_DSCP_field()"><br>\
				</div>\
				<div class="form-group col-md-6">\
					<label class="col-md-5">ECN:</label>\
					<input type="text" id="ECN_input" onfocusout="get_check_ECN_field()"><br>\
				</div>';
					
			IPP_TOS =
				'<div class="form-group col-md-6">\
					<label class="col-md-5">Precedence:</label>\
					<input id="IPP_input" type="text" onfocusout="get_check_IPP_field()"><br>\
				</div>\
				<div class="form-group col-md-6">\
					<label class="col-md-5">Type of Service:</label>\
					<input type="text" id="TOS_input" onfocusout="get_check_TOS_field()"><br>\
				</div>';
			
			STATUS_BAR =
				'<div id="check_status" class="alert alert-danger col-md-12" role="alert" style="visibility: hidden;">\
					Your data may error.\
				</div>';
			
			function type1_section() {
				FLAG_TYPE = 1;
				
				document.getElementById('row1').innerHTML = DSCP_ECN + '\n' + STATUS_BAR;
				document.getElementById('row2').innerHTML = IPP_TOS;
			}
			
			function type2_section() {
				FLAG_TYPE = 2;
			
				document.getElementById('row1').innerHTML = IPP_TOS + '\n' + STATUS_BAR;
				document.getElementById('row2').innerHTML = DSCP_ECN;
			}
			
		</script>
	</head>
	<body>
		<div class="container">
			<div class="col-md-8 col-md-offset-2">
				<div class="row" id="option">
					<h1>Type <small>Step 1</small></h1>
					<div class="radio" align="center">
						<label>
							<input type="radio" name="optionsRadios" onclick="optionClick(1)">DSCP-ECN to IP Precedence-Type of Service
						</label>
					</div>
					<div class="radio" align="center">
						<label>
							<input type="radio" name="optionsRadios" onclick="optionClick(2)">IP Precedence-Type of Service to DSCP-ECN
						</label>
					</div>
				</div>
				
				<div class="row" id="data" hidden="true">
					<h1>Data <small>Step 2</small></h1>
					<div class="col-md-12" id="row1">
						<!-- Fill from Javascript, Function type1_section(); -->
					</div>
					
					<div class="col-md-12" id="row2">
							<!-- Fill from Javascript, Function type2_section(); -->
					</div>
				</div>
				
				<div class="row" id="convert" hidden="true">
					<h1>Convert <small>Step 3</small></h1>
					<div class="col-md-offset-5" id="submit" hidden="true">
						<button class="btn btn-primary" onclick="convert();">Convert</button>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>